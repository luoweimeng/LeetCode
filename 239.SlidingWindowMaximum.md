class Solution {
    public int[] maxSlidingWindow(int[] nums, int k) {
        Deque<Integer> q = new LinkedList<>();
        int[] result = new int[nums.length - k + 1];
        
        if (nums.length == 0)
            return new int[0];
        
        for (int i = 0; i < nums.length; i++) {

            //1 3 -1 -3 5 3 6 7
            //0 1 2 3
            //1 2 3
            //keep the element in q in decreasing orderï¼š pop the element until top >= nums[i]
            while (!q.isEmpty() && nums[q.peekLast()] < nums[i])
                q.removeLast();
            q.offerLast(i);
            if (q.peekFirst() == i - k)
                q.removeFirst();
            if (i >= k - 1)
                result[i-k+1] = nums[q.peekFirst()];
        }
        
        return result;
    }
}
